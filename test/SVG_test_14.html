<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="雪乃☆雫">
  <meta name="keywords" content="なでしこ,なでしこv3,日本語プログラミング言語,なでしこさん">
  <meta name="description" content="日本語プログラミング言語「なでしこ３」のプログラムのこと"> 
<style>
#nako3_canvas {
  margin: 4px;
  border: 1px dotted silver;
}
.nako3_div {
  font-size: 1em;
  line-height: 1.1em;
}
.nako3_div > button {
  margin: 4px;
  padding: 4px;
  font-size: 0.9em;
}
.nako3_div input[type=checkbox] {
  padding: 4px;
  margin: 4px;
}
</style>
  <title>なでしこさん</title>
</head>

<body>

<!-- なでしこの実行エンジン -->
<script defer type="text/javascript" src="https://nadesi.com/v3/cdn.php?v=3.3.80&f=release/wnako3.js&run"></script>

<!-- なでしこのプログラム -->
<script type="なでしこ">
#---テスト用初期設定--------------------------
プログラムタイトルは『画像合成テスト』
「title」にプログラムタイトルをテキスト設定。
「#nako3_div」へDOM親要素設定。
#-----------------------------------------------
!『https://snowdrops89.github.io/SVG_nako3/SVG.nako3』を取り込む。

#------------------------
＃画像合成テスト
#------------------------
母艦＝DOM親要素。

#画像
画像URL＝「https://n3s.nadesi.com/image.php?f=8.jpg」
テストカラー＝「#EB6EA5」

「SVG画像合成テスト」のラベル作成。改行作成。改行作成。
画像合成テスト＝[300,200]のSVG親要素作成。
定義領域＝画像合成テストにSVG定義領域作成。

画像合成法＝{
  "over": "inの画像優先。",
  "in": "inとin2の共通部分。",
  "out": "in2の部分をくり抜く。",
  "atop": "in2にinを重ねる。",
  "xor": "共通部分をくり抜く。",
  "arithmetic": "合成演算。"
}
C=0。列数＝3。
画像合成法を反復
    行＝(C/列数)を整数変換。列＝C%列数。合成法＝対象キー。説明＝対象。

    # グループを作成して描画
    テスト＝画像合成テストにSVGグループ作成。
    テストでSVG描画開始。
    テストカラーにSVG塗り色設定。
    丸＝[40,50]へ40のSVG円描画。
    黒色にSVG塗り色設定。10にSVG文字サイズ設定。
    [10,10]へ合成法をSVG文字描画。
    [10,20]へ説明をSVG文字描画。

    # フィルターを作成
    定義領域にSVGフィルター作成。
    撫子＝[20,30,80,60]に画像URLをSVG画像挿入。
    丸に撫子と「元画像」を合成法でSVG画像合成。

    # グループごと移動させて配置
    テストを[列*100,行*100]だけSVG描画移動。
    C=C+1。
ここまで。

母艦でSVG描画開始。
改行作成。改行作成。

「SVG画像ブレンドテスト」のラベル作成。改行作成。改行作成。
画像ブレンドテスト＝[300,200]のSVG親要素作成。
定義領域＝画像ブレンドテストにSVG定義領域作成。

画像ブレンド合成法＝{
  "ノーマル": "normal",
  "乗算": "multiply",
  "スクリーン合成": "screen",
  "比較暗": "darken",
  "比較明": "lighten"
}
C=0。列数＝3。
画像ブレンド合成法を反復
    行＝(C/列数)を整数変換。列＝C%列数。合成法＝対象。説明＝対象キー。

    # グループを作成して描画
    テスト＝画像ブレンドテストにSVGグループ作成。
    テストでSVG描画開始。
    テストカラーにSVG塗り色設定。
    丸＝[40,50]へ40のSVG円描画。
    黒色にSVG塗り色設定。10にSVG文字サイズ設定。
    [10,10]へ合成法をSVG文字描画。
    [10,20]へ説明をSVG文字描画。

    # フィルターを作成
    定義領域にSVGフィルター作成。
    撫子＝[20,30,80,60]に画像URLをSVG画像挿入。
    丸に撫子と「元画像」を合成法でSVG画像ブレンド。

    # グループごと移動させて配置
    テストを[列*100,行*100]だけSVG描画移動。
    C=C+1。
ここまで。

母艦でSVG描画開始。
改行作成。改行作成。

「SVG画像マージテスト」のラベル作成。改行作成。改行作成。
画像マージテスト＝[120,120]のSVG親要素作成。
定義領域＝画像マージテストにSVG定義領域作成

# 描画
テストカラーにSVG塗り色設定。
丸＝[40,50]へ40のSVG円描画。
黒色にSVG塗り色設定。10にSVG文字サイズ設定。
[10,10]へ「マージ」をSVG文字描画。
[10,20]へ「重ね合わせ」をSVG文字描画。

# フィルターを作成
定義領域にSVGフィルター作成。

# 位置をずらして色を変えたものを作る
丸２＝丸を[40,30]にSVG画像ズラし。
色変え＝丸を水色でSVG画像塗り潰し。
丸２＝丸に色変えと丸２を「in」でSVG画像合成。

# 画像を挿入
撫子＝[20,30,80,60]に画像URLをSVG画像挿入。

# 元画像、ずらして色を変えたもの、挿入した画像の順に重ね合わせる。
丸で[「元画像」,丸２,撫子]をSVG画像マージ。
#-----------------------------------------------
</script>
<div id='nako3_div' class='nako3_div'></div>
<noscript>
このプログラムは、日本語プログラミング言語「なでしこ３」で作成しています。<BR>
Javascriptの動作する環境が必要です。Javascriptを有効にして下さい。<P>
【対応ブラウザ】<BR>
　・HTML5対応ブラウザ (Chrome /Safari /Edge /Firefox 等)<BR>
　・スマホブラウザ (iOS Safari / Android標準ブラウザ)
</noscript>
</body>
</html>
